---
layout: post
title: '服务兼容/数据迁移'
date: 2013-02-25 18:20
comments: true
tags: ['']
---

最近在整理登陆模块的数据兼容和服务兼容。有几点值得注意的地方：

1\. 数据库表格式不一致。这需要格式转换非常令人头痛。

2\. 旧服务不下线，新服务上线后，新的验证机制旧的server不兼容。新验证与旧的验证难以分离。web端和其他各端使用的验证方式不一致，或者说发布/更新速
度不一致。

3\. 新的cookie会通过某些途径进入到web端。我x

4\. 新的服务在某些情况下，需要依赖旧的服务。

这真是令人头痛的一件事。

解决方法：

1\. 新服务在旧服务之前做验证，或者在认证串中加入版本信息。

2\. 新server引入旧服务的所有表，但是只读。不能通过引入表解决的。在旧的server上加http等接口同时限制ip.新server访问这些接口。

3\. nginx 将旧接口映射到新接口。

另外需要开始时，设计好错误码，错误码一旦冲突，并且各个客户端使用了，这就不好办了。另外各个客户端也需要对新旧认证做兼容处理。悲催呀.

